---
title: 'compose() function'
sidebar:
  label: 'compose()'
  order: 0
  badge:
    text: 'fn'
    variant: 'tip'
---

<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](../../) &gt; [@lattice/lattice](../) &gt; compose

## compose() function

Compose service factories into a unified context with shared dependencies.

This is the primary way to create a Lattice context. It supports three patterns:

\*\*Pattern 1: Factory object + deps\*\* (recommended for most cases) Pass an object of service factories and shared dependencies.

**Signature:**

```typescript
export declare function compose<
  T extends Record<string, DefinedService>,
  TDeps extends ExtractDeps<T>,
>(factories: T, deps: TDeps, options?: CreateContextOptions): Svc<T>;
```

## Parameters

<table><thead><tr><th>

Parameter

</th><th>

Type

</th><th>

Description

</th></tr></thead>
<tbody><tr><td>

factories

</td><td>

T

</td><td>

</td></tr>
<tr><td>

deps

</td><td>

TDeps

</td><td>

</td></tr>
<tr><td>

options

</td><td>

[CreateContextOptions](../createcontextoptions/)

</td><td>

_(Optional)_

</td></tr>
</tbody></table>

**Returns:**

[Svc](../svc/)<!-- -->&lt;T&gt;

A context object with all service implementations + `dispose()` method

## Example 1

```ts
import { compose } from '@lattice/lattice';
import { Signal, Computed, Effect } from '@lattice/signals';
import { createHelpers } from '@lattice/signals/presets/core';

const deps = createHelpers();
const ctx = compose(
  { signal: Signal(), computed: Computed(), effect: Effect() },
  deps
);

const count = ctx.signal(0);
const doubled = ctx.computed(() => count() * 2);
```

\*\*Pattern 2: Pre-created ServiceDefinitions\*\* Pass already-instantiated service definitions.

## Example 2

```ts
const signalService = Signal().create(deps);
const computedService = Computed().create(deps);

const ctx = compose(signalService, computedService);
```

\*\*Pattern 3: With instrumentation\*\* Add debugging/profiling to any composition pattern.

## Example 3

```ts
const ctx = compose({ signal: Signal(), computed: Computed() }, deps, {
  instrumentation,
});
```
